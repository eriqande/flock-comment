%!TEX root = flock-comment-main.tex

\section*{Introduction}
In most fields, proposed methods that are 
perceived to be fundamentally novel or new garner more
attention and accolades---and have a higher chance of publication---
than methods that are clearly minor elaborations upon existing work. 
Not surprisingly, then, in articles and manuscripts, authors may 
emphasize the differences and downplay the similarities between their 
work and the published literature.   In molecular ecology, this 
tendency amongst the creators of statistical methodology can make it 
difficult for end-users to understand the relationship between 
different methods.

Of course, new methods almost always build upon pre-existing ones, and 
much is to be gained by understanding the close relationship between 
different statistical methods in use in molecular ecology today.  
Indeed, some authors downplay the similarities between their method and 
existing ones not because they wish to make their method seem more 
novel, but rather because they are genuinely unaware of the close ties 
between their work and existing methods.  Identifying the 
similarities between new and existing work should help the field 
progress more quickly by 1) reducing end-user confusion about whether 
it is necessary to analyze data with a (sometimes overwhelming) variety 
of computer programs; 2) establishing a common language upon which to 
compare different methods; and 3) providing a principled perspective 
from which to argue about the expected strengths and weaknesses of any 
method.

Methods for the unsupervised clustering of genotypes have received 
considerable attention in the molecular ecology literature.  
The best known example of this class of methods is {\sc structure} 
\citep{Pritchardetal2000}.  {\sc structure} itself can be described 
as an elaboration of earlier models used to identify the spawning 
stock of salmon \citep{Smouseetal1990}, and a variety of other 
clustering methods have been developed that are all closely related to 
{\sc structure}, for example {\sc NewHybrids} \citep{And&Tho2002}, {\sc 
BayesAss+} \citep{Wil&Ran2003}, and {\sc baps} 
\citep{Coranderetal2004}. An overview of these similarities can be 
found in \citet{Anderson2009PGAC}.

Recently, a description of the software {\sc flock} was published, 
billing the method as a ``non-Bayesian method [that] 
differs substantially from previous 
clustering algorithms'' \citep[][p.~1333]{Duc&Tur2009}. A following
paper asserts that
\begin{quote}
``{\sc flock} is very different from  other clustering 
programs. It does not sample the space of partitions through small 
random step walks as in MCMC, and it does not try to optimize some 
target function, such as HWLE\@. Briefly stated, it is not based on a 
probabilistic search algorithm. On the contrary, {\sc flock} is 
entirely deterministic'' \citep[][p.~736]{Duc&Tur2012}.
\end{quote}
These papers describe the rationale behind the {\sc flock} algorithm in
intuitive terms with analogies to the coalescence of flocks of birds
or the accretion of snow on a moving snowball, \etc.  

Here, we provide a different perspective on the {\sc flock} algorithm,
showing it to be a special, restricted case of the simulated annealing
algorithm for finding the Bayesian maximum {\em a posteriori} (MAP)
estimate from a marginalized form of the {\sc structure} model with no
admixture and non-correlated allele frequencies. 

\section*{Comparison of methods}
We start with a succinct mathematical description of the {\sc structure}
algorithm, and then\ldots


\subsection*{{\sc structure}}

\subsection*{{\sc flock}}
One issue I have with it is that it is described as a ``procedure'' or 
an ``algorithm,'' without an attempt to see it as a special case of 
well known inference frameworks.


\subsection*{{\sc flock} as a special case of {\sc structure}}

\section*{Results}

\subsection*{{\sc flock} analysis of coasta California steelhead} 
{\sc flock} was run four times using the default setting for all run parameters \textit{(initial partition = random, number of iterations = 20, number of runs = 50, LLOD threshold = 0)} for values of \textit{k} from 2 to 6. The stopping point of \textit{k}=6 was chosen because four consecutive runs with 0 length plateaus were produced. 
Run times were relatively short. The four groups of runs for the default settings averaged 217 minutes (30min SD) on an i7 3.40GHz processor with 8GB of RAM. While no plateaus were observed in any of the four groups for a \textit{k} greater than two, the plateau record varied greatly among each group for \textit{k}=2 (plateau sequences- Run1=3,2,5,6,3; Run2=2,2,2,4,3,2; Run3=2,3,2,4; and Run4=2,3,3,4,2,2,5,2). Using the plateau analysis procedure suggested by \citet{Duc&Tur2012} either \textit{k}=2 is the lower bound estimate (Run1) or there is no estimate (\textit{undecided}: Runs 2-4). Despite different conclusions, the allocation of individuals for the 'best run' from each group differed by a only a single individual. When \textit{k}=2, {\sc flock} identifies a boundary in the Russian Gulch area clustering individuals into northern and southern groups. With increased \textit{k} {\sc flock} splits individuals collected from the same stream between clusters. Increasing the number of iterations from 20 to 100 did not yield an increase in plateau length. 


\section*{Conclusions}
The partition space over which {\sc flock} evaluates how individuals are clustered greatly increases with both the number of individuals and the number of clusters into which they can be partitioned. The total partition space for any given k can be defined by $\sum\limits_{i=1}^k S(n,k)$ where S(n,k) is a Stirling number of the second kind. The results of {\sc flock} depend primarily on the initial partition of individuals. It is not surprising that with 2,596 individuals we could have drastically different plateau sequences with just two clusters. It is difficult to access how well the reallocation process moves the cluster of individuals within the partition space due to the fact that the reallocation matrix from only the 'best-run' is reported. 
